# 訂單簿

訂單簿所需要指定的頻道字串是 book，同時必須指定你想關注的市場 (market)。
我們也提供 `depth` 參數讓你拿到指定的檔數，目前只提供 1, 5, 10 三種檔數。

```json
{
  "channel": "book",
  "market": "btctwd",
  "depth": 1 // optional
}
```

## 成功回應
當你訂閱成功的時候，你會收到一份訂單簿的快照，並且持續收到來自訂單簿的更新。

### 快照
```json
{
 "c": "book",
 "e": "snapshot",
 "M": "btcusdt",
 "a": [["5337.3", "0.1"]],
 "b": [["5333.3", "0.5"]],
 "T": 1591869939634
}
```

### 更新
```json
{
 "c": "book",
 "e": "update",
 "M": "btcusdt",
 "a": [["5337.3", "0.01037"]],
 "b": [],
 "T": 1591869939634
}
```

## 維護你自己本地的訂單簿

請用兩個陣列來存排序後的價格，還有兩個對照表放 price 跟 volume 的對照，bid 跟 ask 都會個用一個陣列跟鍵值表。

1. 收到快照，初始化你的本地訂單簿。
2. 收到更新，當 volume 為 0 代表要將這個價格移除，不然就根據是買或賣加入你的陣列跟對照表，記得要重新排列你的陣列。

```json
// Orderbook
{
  "ask_prices": [],  // 由小到大排序
  "bid_prices": [],  // 由小到大排序
  "ask_volumes": {}, // {"price": "volume"}
  "bid_volumes": {}  // {"price": "volume"}
}
```
